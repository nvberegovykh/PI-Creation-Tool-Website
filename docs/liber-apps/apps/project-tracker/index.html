<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Project Tracker</title>
  <link rel="stylesheet" href="../../css/style.css" />
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="tracker-app">
    <header class="tracker-header">
      <h1><i class="fas fa-tasks"></i> Project Tracker</h1>
      <div class="tracker-header-actions">
        <button type="button" id="make-request-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Make Request</button>
        <button id="back-btn" class="btn btn-secondary"><i class="fas fa-arrow-left"></i> Back</button>
      </div>
    </header>

    <div id="tracker-loading" class="tracker-loading">
      <div class="loading-spinner"></div>
      <p>Loading projects...</p>
    </div>

    <div id="tracker-main" class="tracker-main hidden">
      <section class="panel">
        <div class="tracker-panel-header">
          <h2>My Projects</h2>
          <button type="button" id="make-request-panel-btn" class="btn btn-primary"><i class="fas fa-plus"></i> Make Request</button>
        </div>
        <div id="projects-grid" class="projects-grid"></div>
        <div id="projects-empty" class="tracker-empty hidden">
          <i class="fas fa-folder-open"></i>
          <p>No projects yet.</p>
          <p class="tracker-empty-hint">Submit a request from the main site to create your first project.</p>
        </div>
      </section>
    </div>

    <div id="tracker-detail" class="tracker-detail hidden">
      <section class="panel">
        <div class="detail-header">
          <h2 id="detail-title">Project</h2>
          <div class="detail-actions">
            <a id="detail-chat-link" href="#" class="btn btn-primary" target="_blank" rel="noopener">
              <i class="fas fa-comments"></i> Chat
            </a>
          </div>
        </div>
        <div id="tracker-respond-section" class="tracker-action-section hidden">
          <div class="action-banner action-pending">
            <span>Awaiting admin response. Admin will send a message from Project Manager.</span>
          </div>
        </div>
        <div id="tracker-approve-section" class="tracker-action-section hidden">
          <div class="action-banner action-initializing">
            <span>Awaiting your approval</span>
            <button type="button" id="tracker-approve-btn" class="btn btn-primary"><i class="fas fa-check"></i> I Approve</button>
          </div>
        </div>
        <div id="tracker-approve-review-section" class="tracker-action-section hidden">
          <div class="action-banner action-review">
            <span>Approval awaited from you</span>
            <div class="approve-review-actions">
              <button type="button" id="tracker-approve-review-btn" class="btn btn-primary"><i class="fas fa-check-circle"></i> Approve (Complete)</button>
              <div class="add-comment-wrap">
                <textarea id="tracker-add-comment-message" rows="3" placeholder="Add a comment (admin will respond)..." class="add-comment-textarea"></textarea>
                <label class="add-comment-upload" id="tracker-add-comment-upload" for="tracker-add-comment-files">
                  <input type="file" id="tracker-add-comment-files" multiple accept="image/*,application/pdf,text/*,.doc,.docx,.xls,.xlsx,.csv" />
                  <span>üìé Attach files</span>
                </label>
                <div id="tracker-add-comment-file-list" class="project-form-file-list"></div>
                <button type="button" id="tracker-add-comment-btn" class="btn btn-secondary"><i class="fas fa-comment"></i> Add Comment</button>
              </div>
            </div>
          </div>
        </div>
        <div class="detail-meta">
          <span id="detail-status" class="status-badge"></span>
          <span id="detail-updated"></span>
        </div>
        <div id="tracker-progress-bar" class="tracker-progress-bar">
          <div class="progress-track" id="progress-track">
            <div class="progress-step" data-step="submitted">
              <span class="step-dot"></span>
              <span class="step-label">Submitted</span>
            </div>
            <div class="progress-step" data-step="initializing">
              <span class="step-dot"></span>
              <span class="step-label">Initializing</span>
            </div>
            <div class="progress-step" data-step="in_progress">
              <span class="step-dot"></span>
              <span class="step-label">In Progress</span>
            </div>
            <div class="progress-step" data-step="review">
              <span class="step-dot"></span>
              <span class="step-label">Review</span>
            </div>
            <div class="progress-step" data-step="completed">
              <span class="step-dot"></span>
              <span class="step-label">Completed</span>
            </div>
          </div>
        </div>
        <div id="detail-description" class="detail-description"></div>
        <div id="tracker-responses-section" class="detail-section">
          <h3><button type="button" id="tracker-responses-toggle" class="responses-toggle-btn"><i class="fas fa-chevron-right"></i> Response history</button></h3>
          <div id="tracker-responses-list" class="responses-list hidden"></div>
        </div>
        <div id="members-section" class="detail-section hidden">
          <h3>Team Members</h3>
          <div id="members-list" class="members-list"></div>
          <div id="members-add" class="members-add">
            <input type="email" id="member-email" placeholder="Email to add or invite (creates account if new)" class="member-email-input" />
            <button type="button" id="add-member-btn" class="btn btn-secondary">Add</button>
          </div>
        </div>
        <div class="detail-section">
          <h3>Project Library</h3>
          <div id="library-tabs" class="library-tabs">
            <button class="lib-tab active" data-folder="record_in">Record In</button>
            <button class="lib-tab" data-folder="record_out">Record Out</button>
          </div>
          <div id="library-upload-wrap" class="library-upload-wrap hidden">
            <label>Add files (goes to Record In by type)</label>
            <label class="library-upload-zone" id="library-upload-zone" for="library-upload-input">
              <input type="file" id="library-upload-input" multiple accept="image/*,application/pdf,text/*,.doc,.docx,.xls,.xlsx,.csv,video/*" />
              <div class="library-upload-icon">üìÅ</div>
              <div>Drop files or click to add to Record In</div>
            </label>
          </div>
          <div id="library-content" class="library-content"></div>
          <div id="library-empty" class="tracker-empty hidden">
            <i class="fas fa-files-o"></i>
            <p>No files in this folder.</p>
          </div>
        </div>
        <div id="tracker-review-section" class="detail-section hidden">
          <h3>Leave a Review</h3>
          <p class="review-hint">This project is completed. Share your feedback.</p>
          <textarea id="tracker-review-input" rows="4" placeholder="Write your review..."></textarea>
          <button type="button" id="tracker-review-submit" class="btn btn-primary"><i class="fas fa-star"></i> Submit Review</button>
        </div>
      </section>
    </div>
  </div>

  <link rel="stylesheet" href="../../../components/request-quiz.css" />
  <script>window._ptV='20260222r1';</script>
  <script src="../../js/secure-keys.js"></script>
  <script src="../../js/firebase-loader.js"></script>
  <script src="../../js/firebase-service.js"></script>
  <script src="../../js/chat-iframe-bridge.js"></script>
  <script src="../../../components/request-quiz.js"></script>
  <script src="app.js"></script>
</body>
</html>
